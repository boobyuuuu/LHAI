
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NJU AI programs for LHAASO">
      
      
      
        <link rel="canonical" href="https://boobyuuuu.github.io/LHAI/Content/model/diffusion/">
      
      
        <link rel="prev" href="../transformer/">
      
      
        <link rel="next" href="../../eval/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>DIFFUSION - LHAI User Manual</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
      <link rel="stylesheet" href="../../../css/tasklist.css">
    
      <link rel="stylesheet" href="../../../css/custom.css">
    
      <link rel="stylesheet" href="../../../css/card.css">
    
      <link rel="stylesheet" href="../../../css/flink.css">
    
      <link rel="stylesheet" href="../../../css/changelog_extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link rel="stylesheet" href="../../../assets/stylesheets/custom.00c04c01.min.css">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#diffusion" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="LHAI User Manual" class="md-header__button md-logo" aria-label="LHAI User Manual" data-md-component="logo">
      
  <img src="../../../assets/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LHAI User Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DIFFUSION
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_2">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_3">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_4">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_5">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_6">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../zh/Content/model/diffusion/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/boobyuuuu/LHAI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Index

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data/" class="md-tabs__link">
          
  
  
    
  
  Data Section

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Model Section

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../eval/" class="md-tabs__link">
          
  
  
    
  
  Eval Section

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../codes/" class="md-tabs__link">
          
  
  
    
  
  Codes Section

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../changelog/" class="md-tabs__link">
          
  
  
    
  
  Others Section

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="LHAI User Manual" class="md-nav__button md-logo" aria-label="LHAI User Manual" data-md-component="logo">
      
  <img src="../../../assets/favicon.png" alt="logo">

    </a>
    LHAI User Manual
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/boobyuuuu/LHAI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Data Section
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Data Section
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    simulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tangxiao/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tangxiao
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/jiaoda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    jiaoda
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Model Section
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Model Section
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GAN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transformer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    DIFFUSION
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    DIFFUSION
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1 扩散模型超分辨率发展框架
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-diffusion" class="md-nav__link">
    <span class="md-ellipsis">
      2 DIFFUSION 核心特色与原理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 DIFFUSION 核心特色与原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-forward-process" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 前向扩散过程（Forward Process）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-reverse-process" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 反向生成过程（Reverse Process）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-timestep-embedding" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 时间步条件编码（Timestep Embedding）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-conditional-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 条件控制机制（Conditional Guidance）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 PyTorch 核心实现示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-cnn" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 核心总结（对标 CNN）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2 关键阶段与技术突破
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-cnntransformer" class="md-nav__link">
    <span class="md-ellipsis">
      3 与CNN/Transformer框架的对应关系
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-div2k-4" class="md-nav__link">
    <span class="md-ellipsis">
      4 性能对比（DIV2K ×4 盲超分）
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5 当前研究热点方向
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6 典型改进路径示例
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../eval/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Eval Section
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Eval Section
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eval/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eval/diffusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DIFFUSION
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../codes/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Codes Section
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Codes Section
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SERVER
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/train/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TRAIN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/predict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PREDICT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EVALUATION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/function/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FUNCTION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CONFIG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DATA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DOCS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/lhai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LHAI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codes/saves/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SAVES
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Others Section
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Others Section
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../changelog/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    ChangeLog
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            ChangeLog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HowtoBeCollaborator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    improvement
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            improvement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/GP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GroupMeeting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1 扩散模型超分辨率发展框架
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-diffusion" class="md-nav__link">
    <span class="md-ellipsis">
      2 DIFFUSION 核心特色与原理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 DIFFUSION 核心特色与原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-forward-process" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 前向扩散过程（Forward Process）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-reverse-process" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 反向生成过程（Reverse Process）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-timestep-embedding" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 时间步条件编码（Timestep Embedding）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-conditional-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 条件控制机制（Conditional Guidance）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 PyTorch 核心实现示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-cnn" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 核心总结（对标 CNN）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2 关键阶段与技术突破
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-cnntransformer" class="md-nav__link">
    <span class="md-ellipsis">
      3 与CNN/Transformer框架的对应关系
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-div2k-4" class="md-nav__link">
    <span class="md-ellipsis">
      4 性能对比（DIV2K ×4 盲超分）
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5 当前研究热点方向
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6 典型改进路径示例
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="diffusion">DIFFUSION 类神经网络<a class="headerlink" href="#diffusion" title="Permanent link">&para;</a></h1>
<h2 id="1">1 扩散模型超分辨率发展框架<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<pre class="mermaid"><code>graph TD
    DDPM[2020 DDPM\n去噪扩散概率模型奠基]
    SR3[2021 SR3\n首个扩散超分模型]
    CDM[2021 CDM\n级联扩散模型]
    LDM[2022 LDM\n潜在扩散模型]
    SRDiff[2022 SRDiff\n条件扩散超分]
    DiffIR[2023 DiffIR\nTransformer引导扩散]
    DDNM[2023 DDNM\n零样本扩散超分]
    ResDiff[2023 ResDiff\n残差扩散架构]
    DiffBIR[2024 DiffBIR\n盲复原扩散模型]

    DDPM --&gt; SR3
    SR3 --&gt; CDM
    CDM --&gt; LDM
    LDM --&gt; SRDiff
    SRDiff --&gt; DiffIR
    SRDiff --&gt; DDNM
    DDNM --&gt; DiffBIR
    CDM --&gt; ResDiff</code></pre>
<h2 id="2-diffusion">2 DIFFUSION 核心特色与原理<a class="headerlink" href="#2-diffusion" title="Permanent link">&para;</a></h2>
<p>扩散模型（Diffusion Model）可以看作是一个 <strong>逐步加噪 → 学习去噪</strong> 的生成框架，通过反向扩散过程从噪声重构出清晰图像。它的核心构成可浓缩为 <strong>四大支柱</strong>：</p>
<ol>
<li><strong>前向扩散过程（Forward Diffusion Process）</strong> —— 将真实图像逐步加噪至高斯噪声</li>
<li><strong>反向生成过程（Reverse Process）</strong> —— 学习从噪声逐步去噪重建图像</li>
<li><strong>时间步条件编码（Timestep Embedding）</strong> —— 表示当前生成过程的进度</li>
<li><strong>条件控制机制（Conditional Guidance）</strong> —— 将超分或其他条件信息引入去噪过程</li>
</ol>
<h3 id="21-forward-process">2.1 前向扩散过程（Forward Process）<a class="headerlink" href="#21-forward-process" title="Permanent link">&para;</a></h3>
<p><strong>思想</strong></p>
<p>前向过程是一个固定的马尔可夫链，将数据分布 <span class="arithmatex">\(x_0\)</span> 逐步加噪至各向同性高斯分布 <span class="arithmatex">\(x_T \sim \mathcal{N}(0, I)\)</span>。
这样，模型只需学习逆过程即可生成图像。</p>
<p><strong>数学原理</strong></p>
<p>前向过程定义为：</p>
<div class="arithmatex">\[
q(x_t | x_{t-1}) = \mathcal{N}\left(x_t; \sqrt{1-\beta_t} \, x_{t-1}, \beta_t I \right)
\]</div>
<p>其中：</p>
<ul>
<li><span class="arithmatex">\(t \in \{1, \dots, T\}\)</span> 为时间步</li>
<li><span class="arithmatex">\(\beta_t\)</span> 为噪声强度调度（Noise Schedule）</li>
</ul>
<p>由于高斯的可传递性，可以直接写成：</p>
<div class="arithmatex">\[
q(x_t | x_0) = \mathcal{N}\left(x_t; \sqrt{\bar{\alpha}_t} \, x_0, (1-\bar{\alpha}_t)I \right)
\]</div>
<p>其中：</p>
<div class="arithmatex">\[
\alpha_t = 1 - \beta_t, \quad \bar{\alpha}_t = \prod_{s=1}^t \alpha_s
\]</div>
<hr />
<h3 id="22-reverse-process">2.2 反向生成过程（Reverse Process）<a class="headerlink" href="#22-reverse-process" title="Permanent link">&para;</a></h3>
<p><strong>思想</strong></p>
<p>反向过程是另一个马尔可夫链，目标是估计：</p>
<div class="arithmatex">\[
p_\theta(x_{t-1} | x_t) = \mathcal{N}\left(x_{t-1}; \mu_\theta(x_t, t), \Sigma_\theta(x_t, t) \right)
\]</div>
<p>其中 <span class="arithmatex">\(\mu_\theta\)</span> 由神经网络（如 U-Net、Transformer）预测。</p>
<p>为了简化训练，DDPM 将 <span class="arithmatex">\(\mu_\theta\)</span> 改为预测噪声 <span class="arithmatex">\(\epsilon_\theta(x_t, t)\)</span>，并直接优化：</p>
<div class="arithmatex">\[
\mathcal{L}_{\text{simple}} = \mathbb{E}_{x_0, \epsilon, t}\left[ \| \epsilon - \epsilon_\theta(x_t, t) \|_2^2 \right]
\]</div>
<p>这样，模型学会在任意时间步去除噪声。</p>
<h3 id="23-timestep-embedding">2.3 时间步条件编码（Timestep Embedding）<a class="headerlink" href="#23-timestep-embedding" title="Permanent link">&para;</a></h3>
<p>由于去噪过程依赖时间步 <span class="arithmatex">\(t\)</span>，需要将 <span class="arithmatex">\(t\)</span> 映射为特征向量并注入网络：</p>
<ul>
<li><strong>正余弦编码</strong>（类似 Transformer 位置编码）：</li>
</ul>
<div class="arithmatex">\[
\text{TE}_{(t, 2i)} = \sin\left(\frac{t}{10000^{2i/d}}\right), \quad
\text{TE}_{(t, 2i+1)} = \cos\left(\frac{t}{10000^{2i/d}}\right)
\]</div>
<ul>
<li>或 <strong>可学习嵌入</strong>（Learnable Embedding）</li>
</ul>
<h3 id="24-conditional-guidance">2.4 条件控制机制（Conditional Guidance）<a class="headerlink" href="#24-conditional-guidance" title="Permanent link">&para;</a></h3>
<p>在超分任务中，模型除了接收噪声输入 <span class="arithmatex">\(x_t\)</span>，还会接收低分辨率图像 <span class="arithmatex">\(y\)</span> 作为条件：</p>
<div class="arithmatex">\[
\epsilon_\theta(x_t, t, y)
\]</div>
<p>常见方式：</p>
<ul>
<li><strong>直接拼接</strong>（在通道维度拼接 <span class="arithmatex">\(x_t\)</span> 与上采样后的 <span class="arithmatex">\(y\)</span>）</li>
<li><strong>条件编码</strong>（将 <span class="arithmatex">\(y\)</span> 编码后作为附加输入注入网络特征层）</li>
</ul>
<p>这种机制确保去噪过程受低分辨率图像约束，生成的高分辨率图像既符合数据分布，又与输入一致。</p>
<h3 id="25-pytorch">2.5 PyTorch 核心实现示例<a class="headerlink" href="#25-pytorch" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">SimpleDDPM</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">betas</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>  <span class="c1"># U-Net or Transformer</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">betas</span> <span class="o">=</span> <span class="n">betas</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alphas</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">betas</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_bars</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward_diffusion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="n">sqrt_alpha_bar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_bars</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="n">sqrt_one_minus</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_bars</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="n">xt</span> <span class="o">=</span> <span class="n">sqrt_alpha_bar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">+</span> \
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>             <span class="n">sqrt_one_minus</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">noise</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="k">return</span> <span class="n">xt</span><span class="p">,</span> <span class="n">noise</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="n">xt</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_diffusion</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="n">pred_noise</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">noise</span> <span class="o">-</span> <span class="n">pred_noise</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="26-cnn">2.6 核心总结（对标 CNN）<a class="headerlink" href="#26-cnn" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>模块功能</th>
<th>CNN 对应</th>
<th>Diffusion 对应</th>
</tr>
</thead>
<tbody>
<tr>
<td>特征提取</td>
<td>卷积核提取局部模式</td>
<td>去噪网络提取并还原信号</td>
</tr>
<tr>
<td>生成逻辑</td>
<td>前向卷积映射</td>
<td>逐步去噪重建</td>
</tr>
<tr>
<td>条件控制</td>
<td>输入通道堆叠</td>
<td>条件引导（Conditional Guidance）</td>
</tr>
<tr>
<td>时间控制</td>
<td>固定深度网络</td>
<td>时间步嵌入</td>
</tr>
</tbody>
</table>
<p><strong>一句话核心：</strong> CNN 是一次性映射，Diffusion 是逐步生成；CNN 专注局部卷积，Diffusion 通过多步去噪建模全局分布。</p>
<p>由高斯模糊，模拟加噪过程</p>
<p>然后训练一个模型，让它能够从噪声中恢复出原始图像/或者能够拟合出噪声</p>
<p>这样就能得到清晰的图像。</p>
<p>这个模型，可以是 CNN，可以是 U-Net，也可以是Transformer。</p>
<p>因此说，DIFFUSION和CNN\Transformer不是一个维度的东西，它是一种训练范式，而后者是具体的网络架构。它们可以很好的组合起来。</p>
<h2 id="2">2 关键阶段与技术突破<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>基础理论阶段</strong>  </p>
<ul>
<li><strong>DDPM (2020 NeurIPS)</strong>：建立前向加噪/反向去噪的完整理论框架  </li>
<li><strong>ScoreSDE (2021 ICLR)</strong>：引入随机微分方程统一视角</li>
</ul>
</li>
<li>
<p><strong>超分应用探索</strong>  </p>
<ul>
<li><strong>SR3 (2021 arXiv)</strong>：首次将扩散模型用于超分，采用级联噪声预测<br />
    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># 典型噪声预测网络结构</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">Unet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">down_blocks</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">([</span><span class="n">DownsampleBlock</span><span class="p">(</span><span class="o">...</span><span class="p">)])</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">up_blocks</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">([</span><span class="n">UpsampleBlock</span><span class="p">(</span><span class="o">...</span><span class="p">)])</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">time_embed</span> <span class="o">=</span> <span class="n">SinusoidalPosEmb</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div></li>
</ul>
</li>
<li>
<p><strong>效率优化</strong>  </p>
<ul>
<li><strong>LDM (2022 CVPR)</strong>：在潜在空间进行扩散，计算量减少10倍  </li>
<li><strong>DDNM (2023 CVPR)</strong>：零样本超分，无需训练数据</li>
</ul>
</li>
<li>
<p><strong>融合创新</strong>  </p>
<ul>
<li><strong>DiffIR (2023 ICCV)</strong>：用Transformer预测扩散过程的注意力图  </li>
<li><strong>DiffBIR (2024 CVPR)</strong>：解决盲超分问题（联合去噪+超分）</li>
</ul>
</li>
</ol>
<h2 id="3-cnntransformer">3 与CNN/Transformer框架的对应关系<a class="headerlink" href="#3-cnntransformer" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>技术维度</th>
<th>CNN时代</th>
<th>Transformer时代</th>
<th>Diffusion时代</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>核心机制</strong></td>
<td>局部卷积</td>
<td>全局注意力</td>
<td>迭代去噪</td>
</tr>
<tr>
<td><strong>训练目标</strong></td>
<td>像素级MSE</td>
<td>感知损失</td>
<td>变分下界(ELBO)</td>
</tr>
<tr>
<td><strong>生成方式</strong></td>
<td>确定性映射</td>
<td>确定性生成</td>
<td>随机过程</td>
</tr>
<tr>
<td><strong>优势场景</strong></td>
<td>实时处理</td>
<td>纹理重建</td>
<td>高保真生成</td>
</tr>
</tbody>
</table>
<h2 id="4-div2k-4">4 性能对比（DIV2K ×4 盲超分）<a class="headerlink" href="#4-div2k-4" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>模型</th>
<th>参数量</th>
<th>推理步数</th>
<th>FID</th>
<th>核心创新</th>
</tr>
</thead>
<tbody>
<tr>
<td>SR3</td>
<td>256M</td>
<td>1000</td>
<td>18.7</td>
<td>条件扩散</td>
</tr>
<tr>
<td>LDM</td>
<td>134M</td>
<td>200</td>
<td>15.2</td>
<td>潜在空间扩散</td>
</tr>
<tr>
<td>DiffIR</td>
<td>89M</td>
<td>50</td>
<td>12.3</td>
<td>Transformer引导</td>
</tr>
<tr>
<td>DiffBIR</td>
<td>210M</td>
<td>25</td>
<td>9.8</td>
<td>退化模型联合训练</td>
</tr>
</tbody>
</table>
<h2 id="5">5 当前研究热点方向<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<pre class="mermaid"><code>graph LR
    A[扩散超分] --&gt; B[加速采样]
    A --&gt; C[多模态控制]
    A --&gt; D[三维超分]

    B --&gt; B1[蒸馏加速]
    B --&gt; B2[隐式扩散]

    C --&gt; C1[文本引导]
    C --&gt; C2[语义编辑]

    D --&gt; D1[视频超分]
    D --&gt; D2[CT/MRI增强]</code></pre>
<h2 id="6">6 典型改进路径示例<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>采样加速</strong><br />
   <pre class="mermaid"><code>graph LR
    DDPM --&gt; DDIM[DDIM\n确定性采样]
    DDIM --&gt; PNDM[PNDM\n伪数值方法]
    PNDM --&gt; LCM[LCM\n一致性模型]</code></pre></p>
</li>
<li>
<p><strong>架构演进</strong><br />
   <pre class="mermaid"><code>graph LR
    Unet --&gt; DiT[DiT\nTransformer主干]
    DiT --&gt; U-ViT[U-ViT\n全局建模]
    U-ViT --&gt; LDM[LDM\n潜在空间]</code></pre></p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
        <script src="https://cdn.tonycrane.cc/utils/katex.min.js"></script>
      
        <script src="../../../js/katex.js"></script>
      
    
  </body>
</html>